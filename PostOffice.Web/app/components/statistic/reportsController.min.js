(function(n){function t(n,t,i,r,u,f){function s(){t.get("/api/district/getallparents",null,function(t){n.report.districts=t.data},function(){i.displayError("Không tải được danh sách huyện.")})}function e(){t.get("/api/po/getbydistrictid/ "+f.id,null,function(t){n.report.pos=t.data},function(){i.displayError("Không tải được danh sách đơn vị.")})}function h(){t.get("/api/applicationUser/getuserbypoid/"+f.id,null,function(t){n.report.users=t.data},function(){i.displayError("Không tải được danh sách nhân viên.")})}function o(){t.get("/api/service/getallparents",null,function(t){n.services=t.data},function(){i.displayError("Không tải được danh sách dịch vụ.")})}function c(){n.report.districtId=0;n.report.unitId=0}function l(){var r=n.report.date.startDate.format("MM/DD/YYYY"),u=n.report.date.endDate.format("MM/DD/YYYY"),f={params:{fromDate:r,toDate:u,districtId:n.report.districtId||0,functionId:n.report.functionId||0,poId:n.report.poId||0,userId:n.report.userId||"",serviceId:n.report.serviceId||0}};t.get("api/statistic/rp1",f,function(t){n.loading=!0;(t.status=200)&&(window.location.href=t.data.Message,n.loading=!1)},function(t){t.status==500?(i.displayError("Không có dữ liệu"),n.loading=!1):(i.displayError("Không thể tải dữ liệu"),n.loading=!1)})}n.report={functionId:0,date:{startDate:moment(),endDate:moment()},districts:[],pos:[],users:[],districtId:0,posId:0,userId:"",serviceId:0};f.id=0;n.functions=[{Id:1,Name:"Bảng kê thu tiền tại bưu cục - tổng hợp"},{Id:2,Name:"Bảng kê thu tiền tại bưu cục - chi tiết"},{Id:3,Name:"Bảng kê thu tiền theo nhân viên"}];n.getDistricts=s;n.updatePos=function(t){t!==0&&t!==null?(f.id=t,e()):(n.report.pos=[],n.report.posId=0)};n.getPos=e;n.updateUser=function(t){t!=0&&t!=null?(f.id=t,h()):(n.report.users=[],n.report.userId=0)};n.getListUser=h;n.getService=o;n.Reset=c;n.Report=l;n.isManager=u.haveRole("Manager");n.isAdmin=u.haveRole("Administrator");n.isAdmin||n.isManager?n.isAdmin?s():(f.id=u.authentication.userName,t.get("/api/applicationUser/userinfo",null,function(n){t.get("/api/po/getbyid/"+n.data.POID,null,function(n){f.id=n.data.DistrictID;e()},function(){})},function(){i.displayError("Không tải được danh sách dịch vụ.")})):(f.id=u.authentication.userName,t.get("/api/applicationUser/userinfo",null,function(n){f.id=n.data.Id;o()},function(){i.displayError("Không tải được danh sách dịch vụ.")}));o()}n.controller("reportsController",t);t.$inject=["$scope","apiService","notificationService","$filter","authService","$stateParams","$injector"]})(angular.module("postoffice.statistics"));