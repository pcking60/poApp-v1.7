(function(n){function t(n,t,i,r,u,f){function s(){t.get("/api/district/getallparents",null,function(t){n.report.districts=t.data},function(){i.displayError("Không lấy được danh sách đơn vị / huyện")})}function e(){t.get("/api/po/getbydistrictid/"+f.id,null,function(t){n.report.pos=t.data},function(){i.displayError("Không tải được danh sách đơn vị.")})}function h(){t.get("/api/applicationUser/getuserbypoid/"+f.id,null,function(t){n.report.users=t.data},function(){i.displayError("Không tải được danh sách nhân viên.")})}function o(){t.get("/api/service/getallbyuserid/"+f.id,null,function(t){n.services=t.data},function(){i.displayError("Không tải được danh sách dịch vụ.")})}function c(){n.report.districtId=0;n.report.posId=0;n.report.date={startDate:moment(),endDate:moment()};n.result=!1}function l(){var r=n.report.date.startDate.format("MM-DD-YYYY"),u=n.report.date.endDate.format("MM-DD-YYYY"),f={params:{fromDate:r,toDate:u,districtId:n.report.districtId||0,posId:n.report.posId||0,userId:n.report.userId||"",serviceId:n.report.serviceId||0}};t.get("api/transactions/stattistic",f,function(t){n.statisticResult=t.data;n.report.totalQuantity=0;n.report.totalCash=0;n.report.totalDebt=0;n.report.totalEarn=0;n.report.totalVat=0;angular.forEach(n.statisticResult,function(t){t.Status==!0&&(n.report.totalQuantity+=t.Quantity,n.report.totalCash+=t.TotalCash,n.report.totalDebt+=t.TotalDebt,n.report.totalEarn+=t.EarnMoney,n.report.totalVat+=t.TotalCash+t.TotalDebt-(t.TotalCash+t.TotalDebt)/t.VAT)});n.result=!0;console.log(t.data)},function(n){n.status==500?i.displayError("Không có dữ liệu"):i.displayError("Không thể tải dữ liệu")})}n.statisticResult=[];n.report={date:{startDate:moment(),endDate:moment()},districts:[],pos:[],users:[],districtId:0,posId:0,userId:"",serviceId:0,totalQuantity:0,totalCash:0,totalDebt:0,totalEarn:0,totalVat:0};n.getDistricts=s;n.updatePos=function(t){t!=0&&t!=null?(f.id=t,e()):(n.report.pos=[],n.report.posId=0)};n.updateUser=function(t){t!=0&&t!=null?(f.id=t,h()):(n.report.users=[],n.report.userId=0)};n.updateService=function(t){t!=0&&t!=null?(f.id=t,o()):(n.report.services=[],n.report.serviceId=0)};n.getPos=e;n.getListUser=h;n.getService=o;n.chartdata=[];n.reset=c;n.TimeStatistic=l;n.isManager=u.haveRole("Manager");n.isAdmin=u.haveRole("Administrator");n.isAdmin||n.isManager?n.isAdmin?s():(f.id=u.authentication.userName,t.get("/api/applicationUser/userinfo",null,function(n){t.get("/api/po/getbyid/"+n.data.POID,null,function(n){f.id=n.data.DistrictID;e()},function(){})},function(){i.displayError("Không tải được danh sách dịch vụ.")})):(f.id=u.authentication.userName,t.get("/api/applicationUser/userinfo",null,function(n){f.id=n.data.Id;o()},function(){i.displayError("Không tải được danh sách dịch vụ.")}))}n.controller("timeStatisticController",t);t.$inject=["$scope","apiService","notificationService","$filter","authService","$stateParams"]})(angular.module("postoffice.statistics"));